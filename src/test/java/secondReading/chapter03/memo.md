테스트 코드 작성 순서

2장의 테스트 코드 순서
1. 모든 규칙을 충족하는 암호는 강함
2. 길이만 8글자 미만이고 나머지 규칙은 충족하는 암호의 강도는 보통
3. 숫자를 포함히자 않고 나머지 규칙은 충족하는 암호의 강도는 보통
4. 값이 없는 암호의 강도는 유효하지 않음
5. 대문자를 포함하지 않고 나머지 규칙을 충족하는 경우
6. 길이가 8글자 이상힌 규칙만 충족하는 경우
7. 숫자 포함만 규칙만 충족하는 경우
8. 대문자 포함 규칙만 충족하는 경우
9. 아무 규칙도 충족하지 않는 경우

규칙은 다음과 같다.

-  쉬운 경우에서 어려운 경우로 진행
-  예외적인 경우에서 정상적인 경우로 진행

##### 초반에 복잡한 테스트부터 시작하면 안되는 이유

만약 초반부터 다양한 조합을 검사하는 복잡한 상황을 테스트로 추가하면 해당 테스트를 통과시키기 위해 한 번에 구현해야 할 코드가 많아진다.

##### 구현하기 쉬운 테스트부터 시작하기

- 모든 조건을 충족하는 경우
- 모든 조건을 충족하지 않는 경우

---

- 모든 규칙을 충족하지 않는 경우
- 한 규칙만 충족하는 경우
- 두 규칙을 충족하는 경우

모든 규칙을 충족하지 않는 경우보다 한 가지나 두 규칙을 충족하는 게 쉬울 것이라 예상

##### 예외 상황을 먼저 테스트 해야 하는 이유

다양한 예외 상황은 복잡한 if-else 블록을 동반할 때가 많다. 
예외 상황을 고려하지 않은 코드에 예외 상황을 예외 상황을 반영하려면
코드의 구조를 뒤집거나 코드 중간에 예외 상황을 처리하기 위해 조건문을 중복해서 추가하는 일이 벌어진다.

초반에 예외 상황을 테스트하면 이러한 가능성이 줄어진다. 예외 상황에 따른 if-else 구조가 미리 만들어지기 때문에 
많은 코드를 완성한 뒤에 예외 상황을 반영할 때보다 코드 구조가 덜 바뀐다.

NPE 때문에 프로세스가 죽는 일이 생긴적이 있다. 예외 상황을 찾고 테스트하면 이런 문제가 발생할 가능성을 사전에 낮출 수 있다.


##### 완급 조절

처음 TDD 로 구현할 때 어려운 것 중 하나는 한 번에 얼마만큼의 코드를 작성할 것인가이다.
TDD 를 처음 접할 때는 다음 단계에 따라 TDD 를 익혀보자.

1. 정해진 값을 리턴
2. 값 비교를 이용해서 정해진 값을 리턴
3. 다양한 테스트를 추가하면서 구현을 일반화

뻔한 구현이라도 위의 단계를 거처셔 연습하면 개발자는 조금씩 기능을 구현해 나갈 수 있다.
위의 과정을 연습하면 나중에 만들어야 할 코드가 잘 떠오리지 않을 때 점진적으로 구현을 진행할 수 있는 밑거름이 된다.

TDD 가 익숙해지면 상황에 따라 구현 속도를 조절할 수 있다. 한 번에 구현했다가 잘 안되면 한 발짝 물러서서 천천히 단계를 밟아 나가면 된다.

##### 지속적인 리팩토링

테스트를 통과한 뒤에는 리팩토링을 진행한다.
매번 할 필요는 없지만 적당한 후보가 보이면 리팩토링 한다.

### 테스트 작성 순서 연습

매달 비용을 지불하는 유료 서비스

- 서비스를 사용하려면 매달 1만 원을 선불로 납부한다. 납부일 기준으로 한 달 뒤가 서비스 만료일이 된다.
- 2개월 이상 요금을 납부할 수 있다.
- 10만 원을 납부하면 서비스를 1년 제공한다.

##### 쉬운 것부터 테스트

- 구현하기 쉬운 것부터 먼저 테스트
- 예외 상황을 먼저 테스트

##### 예를 추가하면서 구현을 일반화

##### 코드 정리 : 중복 제거
 
보통은 중복을 제거하는 것이 좋지만, 테스트 코드의 중복 제거는 고민이 필요하다.
왜나하면, 각 테스트 메서드는 스스로 머잇을 테스트하는지 명확하게 설명할 수 있어야 하기 때문이다.
테스트 코드의 구현 중복을 기계적으로 제거하면 자칫 테스트 메서드가 검증하고 싶은 내용을 알아보기 힘들 수 있다.

##### 예외 상황 처리

- 납부일이 2019-01-31 이고 납부액이 1만 원 이면 만료일은 2019-02-28 이다.
- 납부일이 2019-05-31 이고 납부액이 1만 원 이면 만료일은 2019-06-30 이다.
- 납부일이 2020-01-31 이고 납부액이 1만 원 이면 만료일은 2020-02-29 이다.

##### 다음 테스트 선택: 다시 예외 상황

- 쉬운 예
   - 2만 원을 지불하면 만료일이 두 달 뒤가 된다.
   - 3만 원을 지불하면 만료일이 두 달 뒤가 된다.
    
- 예외 상황
  - 첫 납부일이 2019-01-31이고 만료되는 2019-02-28에 1만 원을 납부하면 다음 만료일은 2019-03-31이다.
  - 첫 납부일이 2019-01-30이고 만료되는 2019-02-28에 1만 원을 납부하면 다음 만료일은 2019-03-30이다.
  - 첫 납부일이 2019-05-31이고 만료되는 2019-06-30에 1만 원을 납부하면 다음 만료일은 2019-07-31이다.

##### 다음 테스트를 추가하기 전에 리팩토링

##### 예외 상황 테스트 진행 계속

##### 코드 정리: 상수를 변수로

##### 다음 테스트 선택 : 쉬운 테스트

- 2만 원을 지불하면 만료일이 두 달 뒤가 된다.
- 3만 원을 지불하면 만료일이 석 달 뒤가 된다.

##### 예외 상황 테스트 추가

첫 납부일과 납부일 일자가 다를 때 2만 원 이상 납부한 경우

- 첫 납부일이 2019-01-31 이고 만료일이 2019-02-28에 2만원을 납부하면 다음 만료일은 2019-04-31이다.

##### 코드 정리




